import{a as p}from"./apexcharts.min-W9qwUyMS.js";let u=null,y=[1.1,1.1,.9,.9,.8,.7,.5],f=[30,30,40,45,50,60,70],m,r="celda_1",l="jg";async function I(n,a=24){const e=l,t=await fetch(p.llenarGraficos,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({celda:n,metrica:e,rangoHoras:a})});if(!t.ok)throw new Error(`HTTP error! status: ${t.status}`);return(await t.json()).map(o=>({x:new Date(o.fecha_registro).getTime(),y:o[e]}))}async function b(n,a,e=24){const t=await fetch(p.llenarTabla,{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({celda:n,columnas:a,rangoHoras:e})});if(!t.ok)throw new Error(`HTTP error! status: ${t.status}`);return await t.json()}async function d(n){const t=(await b(n,["jg","hf","ro","sb","eg","fecha_registro"])).reverse(),s=document.querySelector(".table tbody");s.innerHTML="",t.forEach(o=>{const c=`<tr>
            <td>${o.jg}</td>
            <td>${o.hf}</td>
            <td>${o.ro}</td>
            <td>${new Date(o.fecha_registro).toLocaleDateString()}</td>
        </tr>`;s.innerHTML+=c})}async function i(n,a=24){r=n;const e=parseInt(n.split("_")[1],10);document.getElementById("chartTitle").innerText=`Celda ${e} - ${l.toUpperCase()}`;const t=await I(n,a),s=l==="jg"?y[e-1]:f[e-1],o=t.length?t.map(h=>({x:h.x,y:s})):[],c={series:[{name:l.toUpperCase(),data:t},{name:"Setpoint",data:o,color:"#00FF00"}],chart:{type:"line",height:550,animations:{enabled:!0},background:"white",toolbar:{tools:{download:!0,selection:!0,zoom:!0,zoomin:!0,zoomout:!0,pan:!0,reset:!0|'<img src="/static/icons/reset.png" width="20">',customIcons:[]},autoSelected:"zoom"}},xaxis:{type:"datetime",labels:{style:{colors:"#000000"}},axisTicks:{color:"#000000"},axisBorder:{color:"#000000"}},yaxis:{labels:{style:{colors:"#000000"}},axisTicks:{color:"#000000"},axisBorder:{color:"#000000"}},grid:{borderColor:"#000000"},title:{text:`Datos de las Ãºltimas ${a} horas para celda ${e}`,style:{color:"#000000"}},stroke:{width:[2,2],colors:["#000000"]},markers:{size:[4,0]},tooltip:{shared:!0,intersect:!1,style:{colors:["#000000"]}},legend:{show:!0,labels:{colors:"#000000"}}},g=document.querySelector("#chart");u?u.updateOptions(c):(u=new ApexCharts(g,c),u.render()),clearInterval(m),m=setInterval(()=>{i(r,parseInt(document.getElementById("timeRangeSelector").value,10))},6e4)}function T(n,a=300){let e;return(...t)=>{clearTimeout(e),e=setTimeout(()=>{n.apply(this,t)},a)}}document.addEventListener("DOMContentLoaded",()=>{document.querySelectorAll(".navbar-nav .nav-link").forEach(e=>{e.addEventListener("click",function(t){t.preventDefault();const o=`celda_${this.textContent.trim().split(" ")[1]}`,c=parseInt(document.getElementById("timeRangeSelector").value,10);i(o,c),d(o)})});const n=T((e,t)=>{i(e,t),d(e)});document.getElementById("timeRangeSelector").addEventListener("change",function(){const e=parseInt(this.value,10);n(r,e)}),document.getElementById("btnJG").addEventListener("click",function(){l="jg",i(r,parseInt(document.getElementById("timeRangeSelector").value,10)),d(r)}),document.getElementById("btnHF").addEventListener("click",function(){l="hf",i(r,parseInt(document.getElementById("timeRangeSelector").value,10)),d(r)});const a=parseInt(document.getElementById("timeRangeSelector").value,10);i(r,a),d(r)});
